<!DOCTYPE html>
<meta charset="utf-8">
    <style>
        
        .dot circle {
            fill: yellow;
            stroke: black;
            stroke-width: 1.5px;
        }
        
        .dot circle.dragging {
            fill: red;
            stroke: brown;
        }
        
        .axis line {
            fill: none;
            stroke: #000;
            stroke-width: 1;
            opacity: 1;
            shape-rendering: crispEdges;
            vector-effect: non-scaling-stroke;
        }
        
        #tooltip {
            position: absolute;
            width: 200px;
            height: auto;
            padding: 10px;
            background-color: white;
            -webkit-border-radius: 10px;
            -moz-border-radius: 10px;
            border-radius: 10px;
            -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
            -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
            box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
            pointer-events: none;
        }
        
        #tooltip.hidden {
            display: none;
        }
        
        #tooltip p {
            margin: 0;
            font-family: sans-serif;
            font-size: 16px;
            line-height: 20px;
        }
        
        </style>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    <body>
        <p> Press on any part of the chart to add. Hold the shift-key and  
            press on a dot to delete. Dots are draggable.</p>
            
            
            
            
            
            
            
   <!-- D3 script -->        
        <script src="assets/d3.v3.min.js"></script>
        <script>
            var mode = 0;
            var isDrag = 1;
            
            var margin = {top: -5, right: -5, bottom: -5, left: -5},
            width = 960 - margin.left - margin.right,
            height = 500 - margin.top - margin.bottom;
            
            var zoom = d3.behavior.zoom()
            .scaleExtent([1, 5])
            .on("zoom", zoomed);
            
            var drag = d3.behavior.drag()
            //.origin(function(d) { return d; })
            .on("dragstart", dragstarted)
            .on("drag", dragged)
            .on("dragend", dragended);
            
            var svg = d3.select("body").append("svg")
			.attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.right + ")")
            .on("click", added)   // adds a new dot
            .call(zoom);

            var defs = svg.append("defs");
            
            defs.append('svg:linearGradient')
            .attr('x1', "0%").attr('y1', "100%").attr('x2', "0%").attr('y2', "0%")
            .attr('id', 'tempgradient').call(
                                         function (gradient) {
                                         gradient.append('svg:stop').attr('offset', '0%').attr('style', 'stop-color:rgb(0,23,153);stop-opacity:.7');
                                         gradient.append('svg:stop').attr('offset', '10%').attr('style', 'stop-color:rgb(1,27,236);stop-opacity:.7');
                                         gradient.append('svg:stop').attr('offset', '20%').attr('style', 'stop-color:rgb(0,56,255);stop-opacity:.7');
                                         gradient.append('svg:stop').attr('offset', '30%').attr('style', 'stop-color:rgb(0,84,255);stop-opacity:.7');
                                         gradient.append('svg:stop').attr('offset', '40%').attr('style', 'stop-color:rgb(0,160,254);stop-opacity:.7');
                                         gradient.append('svg:stop').attr('offset', '45%').attr('style', 'stop-color:rgb(0,208,255);stop-opacity:.7');
                                         gradient.append('svg:stop').attr('offset', '50%').attr('style', 'stop-color:rgb(158,255,100);stop-opacity:.7');
                                         gradient.append('svg:stop').attr('offset', '60%').attr('style', 'stop-color:rgb(255,229,49);stop-opacity:.7');
                                         gradient.append('svg:stop').attr('offset', '75%').attr('style', 'stop-color:rgb(255,102,0);stop-opacity:.7');
                                         gradient.append('svg:stop').attr('offset', '85%').attr('style', 'stop-color:rgb(214,19,0);stop-opacity:.7');
                                         gradient.append('svg:stop').attr('offset', '100%').attr('style', 'stop-color:rgb(30,30,30);stop-opacity:.7');
                                         });
            
            
            var rect = svg.append("rect")
            .attr("width", width)
            .attr("height", height)
            .style("fill", "url(#tempgradient)")
            .style("pointer-events", "all");
            
            var container = svg.append("g");
            
            
			// add axes ---> svg.append( but then what kind of thing should it be?  Line?  rect? ...look it up.
            var x = d3.time.scale()  //set time scale
					.domain([10000,100000])
					.range([0, width]),
                y = d3.scale.linear()  //set temp scale
					.domain([40,90])
					.range([height, 0]); 
            
            var xAxis = d3.svg.axis().scale(x).orient("bottom"), 
                yAxis = d3.svg.axis().scale(y).orient("left");
            
            
            container.append("g")
            .attr("class", "x axis")
            .selectAll("line")
            .data(d3.range(0, width, 100))
            .enter().append("line")
            .attr("x1", function(d) { return d; })
            .attr("y1", 0)
            .attr("x2", function(d) { return d; })
            .attr("y2", height);
            
            container.append("g")
            .attr("class", "y axis")
            .selectAll("line")
            .data(d3.range(0, height, 50))
            .enter().append("line")
            .attr("x1", 0)
            .attr("y1", function(d) { return d; })
            .attr("x2", width)
            .attr("y2", function(d) { return d; });
            
            var initGraph = function() {
                d3.tsv("test.tsv", dottype, function(error, dots) {
                       dot = container.append("g")
                       .attr("class", "dots")
                       .selectAll("circle")
                       .data(dots)
                       .enter().append("g")
                       .attr("class", "dot")
                       .append("circle")
                       .attr("r", 10)
                       .attr("cx", function(d) { return d.x; })
                       .attr("cy", function(d) { return d.y; })
                       .on("click", context)
                       .call(drag);
                       });
            } 
            
            
            function dottype(d) {
                d.x = +d.x;
                d.y = +d.y;
                return d;
            }
            
            function zoomed() {
                if (mode == 5) {
                    rect.attr("transform", "translate(" + d3.event.translate + ")scale(" + d3.event.scale + ")");
                    container.attr("transform", "translate(" + d3.event.translate + ")scale(" + d3.event.scale + ")");
                }
            }
           
            
			
			
			
			
			
			
			// Add a dot where the user clicks:
			var MyPoints = [];
			
            function added() {
                if (isDrag == 0) {
                    var coords = d3.mouse(this);
                    var DotGroup = container.select(".dots").append("g");
					DotGroup.attr("class", "dot")                    
                    .append("circle")
						.attr("r", 10)
						.attr("cx", function(d) { return coords[0]; })
						.attr("cy", function(d) { return coords[1]; });
						
					//try to add text to each dot:
					DotGroup.append("text")
						.attr("dx", 14)
						.attr("dy", ".35em")
						.attr("x", function(d) { return coords[0] - 30; })
						.attr("y", function(d) { return coords[1]; })
						.text("Zoot!");
					
					DotGroup.on("click", context)                
                    	.call(drag);
					
					
					//to pull temp & time from x,y pixel values:
					
					var TransformedCoords = 
					    [x.invert(coords[0]), y.invert(coords[1])];
						 //   [x.invert(coords[0]), y.invert(coords[1])];
					MyPoints.push(TransformedCoords);
					
			
					
					
					
                } else {
                    isDrag = 0;
                }
            }
            
            function context() {
                if (d3.event.shiftKey) {
                    d3.select(this).remove();
                }
            }
            
            function dragstarted(d) {
                isDrag = 1;
                d3.event.sourceEvent.stopPropagation();
                d3.select(this).classed("dragging", true);
            }
            
            function dragged(d) {
                console.log(d3.event.x);
                console.log(d3.event.y);
                d3.select(this).attr("cx", function() { return d3.event.x; })
                .attr("cy", function() { return d3.event.y; });
            }
            
            function dragended(d) {
                d3.select(this).classed("dragging", false);
            }
            
            initGraph();
            
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
            </script>


